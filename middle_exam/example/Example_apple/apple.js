
const modal = [
    {
        ModelType: "iPhone 15 pro",
        type: "model",
        name: "iPhone 15 pro",
        price: "36,900",
        capacity: "128GB",
        photo: "iphone-15-pro-img/iphone-15-pro",
    },
    {
        ModelType: "iPhone 15 pro",
        type: "model",
        name: "iPhone 15 pro",
        price: "40,400",
        capacity: "256GB"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "model",
        name: "iPhone 15 pro",
        price: "47,400",
        capacity: "512GB"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "model",
        name: "iPhone 15 pro",
        price: "54,400",
        capacity: "1TB"
    },

    {
        ModelType: "iPhone 15 pro",
        type: "model",
        name: "iPhone 15 pro Max",
        price: "44,900",
        capacity: "256GB",
    },
    {
        ModelType: "iPhone 15 pro",
        type: "model",
        name: "iPhone 15 pro Max",
        price: "51,900",
        capacity: "512GB",
    },
    {
        ModelType: "iPhone 15 pro",
        type: "model",
        name: "iPhone 15 pro Max",
        price: "58,900",
        capacity: "1TB",
    },


    {
        ModelType: "iPhone 15 pro",
        type: "color",
        name: "original",
        color: "原",
        img: "./iphone-15-pro-img/iphone-pro-color-1.jfif"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "color",
        name: "blue",
        color: "藍",
        img: "./iphone-15-pro-img/iphone-pro-color-2.jfif"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "color",
        name: "white",
        color: "白",
        img: "./iphone-15-pro-img/iphone-pro-color-3.jfif"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "color",
        name: "black",
        color: "黑",
        img: "./iphone-15-pro-img/iphone-pro-color-4.jfif"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro",
        color: "original",
        img: "./iphone-15-pro-color-img/iphone-15-pro-original-1.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro",
        color: "original",
        img: "./iphone-15-pro-color-img/iphone-15-pro-original-2.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro",
        color: "original",
        img: "./iphone-15-pro-color-img/iphone-15-pro-original-3.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro",
        color: "blue",
        img: "./iphone-15-pro-color-img/iphone-15-pro-blue-1.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro",
        color: "blue",
        img: "./iphone-15-pro-color-img/iphone-15-pro-blue-2.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro",
        color: "blue",
        img: "./iphone-15-pro-color-img/iphone-15-pro-blue-3.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro",
        color: "white",
        img: "./iphone-15-pro-color-img/iphone-15-pro-white-1.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro",
        color: "white",
        img: "./iphone-15-pro-color-img/iphone-15-pro-white-2.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro",
        color: "white",
        img: "./iphone-15-pro-color-img/iphone-15-pro-white-3.webp"
    }, {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro",
        color: "black",
        img: "./iphone-15-pro-color-img/iphone-15-pro-black-1.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro",
        color: "black",
        img: "./iphone-15-pro-color-img/iphone-15-pro-black-2.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro",
        color: "black",
        img: "./iphone-15-pro-color-img/iphone-15-pro-black-3.webp"
    },
    //max
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro Max",
        color: "original",
        img: "./iphone-15-pro-color-img/iphone-15-pro-Max-original-1.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro Max",
        color: "original",
        img: "./iphone-15-pro-color-img/iphone-15-pro-Max-original-2.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro Max",
        color: "original",
        img: "./iphone-15-pro-color-img/iphone-15-pro-Max-original-3.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro Max",
        color: "blue",
        img: "./iphone-15-pro-color-img/iphone-15-pro-Max-blue-1.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro Max",
        color: "blue",
        img: "./iphone-15-pro-color-img/iphone-15-pro-Max-blue-2.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro Max",
        color: "blue",
        img: "./iphone-15-pro-color-img/iphone-15-pro-Max-blue-3.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro Max",
        color: "white",
        img: "./iphone-15-pro-color-img/iphone-15-pro-Max-white-1.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro Max",
        color: "white",
        img: "./iphone-15-pro-color-img/iphone-15-pro-Max-white-2.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro Max",
        color: "white",
        img: "./iphone-15-pro-color-img/iphone-15-pro-Max-white-3.webp"
    }, {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro Max",
        color: "black",
        img: "./iphone-15-pro-color-img/iphone-15-pro-Max-black-1.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro Max",
        color: "black",
        img: "./iphone-15-pro-color-img/iphone-15-pro-Max-black-2.webp"
    },
    {
        ModelType: "iPhone 15 pro",
        type: "image",
        name: "iPhone 15 pro Max",
        color: "black",
        img: "./iphone-15-pro-color-img/iphone-15-pro-Max-black-3.webp"
    },
    //type iphone 15
    {
        ModelType: "iPhone 15",
        type: "model",
        name: "iPhone 15",
        price: "29,900",
        capacity: "128GB",
        photo: "iphone-15-img/iphone-15",
    },
    {
        ModelType: "iPhone 15",
        type: "model",
        name: "iPhone 15",
        price: "33,400",
        capacity: "256GB"
    },
    {
        ModelType: "iPhone 15",
        type: "model",
        name: "iPhone 15",
        price: "40,400",
        capacity: "512GB"
    },
    //plus
    {
        ModelType: "iPhone 15",
        type: "model",
        name: "iPhone 15 Plus",
        price: "32,900",
        capacity: "256GB",
    },
    {
        ModelType: "iPhone 15",
        type: "model",
        name: "iPhone 15 Plus",
        price: "36,400",
        capacity: "512GB",
    },
    {
        ModelType: "iPhone 15",
        type: "model",
        name: "iPhone 15 Plus",
        price: "43,400",
        capacity: "1TB",
    },
    //顏色
    {
        ModelType: "iPhone 15",
        type: "color",
        name: "blue",
        color: "藍",
        img: "./iphone-15-img/iphone-15-blue.jfif"
    },
    {
        ModelType: "iPhone 15",
        type: "color",
        name: "pink",
        color: "粉紅",
        img: "./iphone-15-img/iphone-15-pink.jfif"
    },
    {
        ModelType: "iPhone 15",
        type: "color",
        name: "yellow",
        color: "黃",
        img: "./iphone-15-img/iphone-15-yellow.jfif"
    },
    {
        ModelType: "iPhone 15",
        type: "color",
        name: "green",
        color: "綠",
        img: "./iphone-15-img/iphone-15-green.jfif"
    },
    {
        ModelType: "iPhone 15",
        type: "color",
        name: "black",
        color: "黑",
        img: "./iphone-15-img/iphone-15-black.jfif"
    },
    //15 照片
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "blue",
        img: "./iphone-15-color-img/iphone-15-blue-1.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "blue",
        img: "./iphone-15-color-img/iphone-15-blue-2.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "blue",
        img: "./iphone-15-color-img/iphone-15-blue-3.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "pink",
        img: "./iphone-15-color-img/iphone-15-pink-1.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "pink",
        img: "./iphone-15-color-img/iphone-15-pink-2.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "pink",
        img: "./iphone-15-color-img/iphone-15-pink-3.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "yellow",
        img: "./iphone-15-color-img/iphone-15-yellow-1.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "yellow",
        img: "./iphone-15-color-img/iphone-15-yellow-2.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "yellow",
        img: "./iphone-15-color-img/iphone-15-yellow-3.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "green",
        img: "./iphone-15-color-img/iphone-15-green-1.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "green",
        img: "./iphone-15-color-img/iphone-15-green-2.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "green",
        img: "./iphone-15-color-img/iphone-15-green-3.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "black",
        img: "./iphone-15-color-img/iphone-15-black-1.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "black",
        img: "./iphone-15-color-img/iphone-15-black-2.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15",
        color: "black",
        img: "./iphone-15-color-img/iphone-15-black-3.webp"
    },
    //pius img
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "blue",
        img: "./iphone-15-color-img/iphone-15-Plus-blue-1.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "blue",
        img: "./iphone-15-color-img/iphone-15-Plus-blue-2.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "blue",
        img: "./iphone-15-color-img/iphone-15-Plus-blue-3.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "pink",
        img: "./iphone-15-color-img/iphone-15-Plus-pink-1.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "pink",
        img: "./iphone-15-color-img/iphone-15-Plus-pink-2.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "pink",
        img: "./iphone-15-color-img/iphone-15-Plus-pink-3.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "yellow",
        img: "./iphone-15-color-img/iphone-15-Plus-yellow-1.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "yellow",
        img: "./iphone-15-color-img/iphone-15-Plus-yellow-2.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "yellow",
        img: "./iphone-15-color-img/iphone-15-Plus-yellow-3.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "green",
        img: "./iphone-15-color-img/iphone-15-Plus-green-1.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "green",
        img: "./iphone-15-color-img/iphone-15-Plus-green-2.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "green",
        img: "./iphone-15-color-img/iphone-15-Plus-green-3.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "black",
        img: "./iphone-15-color-img/iphone-15-Plus-black-1.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "black",
        img: "./iphone-15-color-img/iphone-15-Plus-black-2.webp"
    },
    {
        ModelType: "iPhone 15",
        type: "image",
        name: "iPhone 15 Plus",
        color: "black",
        img: "./iphone-15-color-img/iphone-15-Plus-black-3.webp"
    },
]

const navbarNavlist = document.querySelector("#navbarNav");
navbarNavlist.addEventListener("click", (e) => {
    console.log(e.target.id)
    const selectlistID = e.target.id;
    pageTo15pro(selectlistID);

})
const iphone15prolist = document.querySelector("#iPhone_15_pro");
let selectlistItem;//承接list 選擇
let Max;//接maxtitle
let Plus;//接Plusetitle
let selecttypeItem;//接選擇機型
let selectcolorItem;//選擇顏色
let initcolor;//初始顏色
let selectimageItem;//圖片
let selectcapacityItem;//選擇容量
let typebtntwoName;//承接btn第二個機型按鈕
const detaildiv = document.querySelector(".detail");


//輪播初始
const carouselimg = document.querySelector("#carouselimg");
const title = document.querySelector("#phonetitle");
function pageTo15pro(selectlistID) {
    //選擇頁面 先給預設
    const modaltitle = modal.find(item => {
        if (selectlistID === "iPhone_15_pro") {
            Max = modal.filter(item => item.name.includes("Max"));
            selectlistItem = "iPhone 15 pro";
            selecttypeItem = "iPhone 15 pro";
            typebtntwoName = Max;
            return item.ModelType === "iPhone 15 pro";
        } else if (selectlistID === "iPhone_15") {
            Plus = modal.filter(item => item.name.includes("Plus"));
            selectlistItem = "iPhone 15";
            selecttypeItem = "iPhone 15";
            typebtntwoName = Plus;
            return item.ModelType === "iPhone 15";
        }
        return false;
    });
    typeToCapacity(modaltitle.ModelType);//產生容量選擇    
    phoneTitle(modaltitle);//購買標題
    carouselimg.innerHTML = `<div class="carousel-item active">
                    <img src="./${modaltitle.photo}-1.webp" class="d-block w-100" alt="...">
                </div>
                <div class="carousel-item">
                    <img src="./${modaltitle.photo}-2.webp" class="d-block w-100" alt="...">
                </div>
                <div class="carousel-item">
                    <img src="./${modaltitle.photo}-3.webp" class="d-block w-100" alt="...">
                </div>`;

    typebtn(modaltitle, typebtntwoName);//產生機型選擇
    phonecolor();//產生顏色選擇
}
//phoneTitle
function phoneTitle(modeltitle) {
    if (!selecttypeItem) return;
    title.innerHTML = `<h1>購買 ${modeltitle.name}</h1>           
    <div class='col-12'>NT$${modeltitle.price} 起</div>`;
}
//機型選項
function typebtn(modaltitle, typebtntwoName) {
    typebtnOne.innerHTML = `<div class="fs-5">${modaltitle.name}</div>
                    <div class="fs-6">NT$${modaltitle.price} 起</div>`;
    typebtntwo.innerHTML = `<div class="fs-5">${typebtntwoName[0].name}</div>
        <div class="fs-6">NT$${typebtntwoName[0].price} 起</div>`;
    typebtnOne.dataset.value = `${modaltitle.name}`;
    typebtntwo.dataset.value = `${typebtntwoName[0].name}`;

    typebtnOne.classList.remove("border-primary");
    typebtntwo.classList.remove("border-primary");
}
function phonecolor() {
    const color = modal.filter(item => item.ModelType === selectlistItem && item.type === "color");
    colorselect.innerHTML = "";
    color.forEach(item => {
        colorselect.innerHTML += ` <div class="col">
                    <div class="border rounded-3 p-1 text-center" role="button" data-color="${item.name}">
                        <img class="w-100" src="${item.img}" alt="${item.color}" data-color="${item.name}">
                    </div>
                </div>`;
    })
}

const typebtnOne = document.querySelector("#type_btn_one");
const typebtntwo = document.querySelector("#type_btn_two");
const colorselect = document.querySelector("#color_select");
const capacityselect = document.querySelector("#capacity_select");

//機型點選
typebtnOne.addEventListener("click", () => {
    typebtnOne.classList.add("border-primary");
    typebtntwo.classList.remove("border-primary"); 
    const selectname = typebtnOne.dataset.value;
    typeToCapacity(selectname);  

    selectcapacityItem = "";//重新選擇機型 種類選項清空
    selecttypeItem = selectname;//機型選擇

    if (!initcolor) {
        if (selectlistItem === "iPhone 15 pro") {
            initcolor = "original";
        }
        initcolor = "blue";
    } 
    imgchang(initcolor);

    const onetitle = modal.find(item => item.type === "model" && item.name === selectname);
    phoneTitle(onetitle);

    init();
    detailchange();//清單變化

})
typebtntwo.addEventListener("click", () => {
    typebtntwo.classList.add("border-primary");
    typebtnOne.classList.remove("border-primary"); 
    const selectname = typebtntwo.dataset.value;
    typeToCapacity(selectname);

    selectcapacityItem = "";//重新選擇機型 種類選項清空
    selecttypeItem = selectname;//機型選擇

    if (!initcolor) {
        if (selectlistItem === "iPhone 15 pro") {
            initcolor = "original";
        }
        initcolor = "blue";
    }
    imgchang(initcolor);

    const onetitle = modal.find(item => item.type === "model" && item.name === selectname);
    phoneTitle(onetitle);

    init();
    detailchange();//清單變化

})
const colortxtchange = document.querySelector("#color_txt_change");
colorselect.addEventListener("click", (e) => {         
    //選到的顏色格子
    
    if(!e.target.closest(".col"))return;//避免點選到邊邊空白
    const targetcol = e.target.closest(".col").children[0];
    colorselectchange(targetcol);
    //選到的顏色
    const targetcolor = e.target.dataset.color;

    if(!targetcolor)return;//避免點選到邊邊空白
    imgchang(targetcolor); 

    initcolor = targetcolor;//先選初始顏色
    //顏色文字change
    const txtcolor = modal.find(item => item.type === "color" && item.name === targetcolor);    
    colortxtchange.textContent = `顏色 - ${txtcolor.color}色鈦金屬`;

    selectcolorItem = txtcolor.color;//清單顏色文字
    detailchange();//清單變化
})
//機型選擇 容量選擇數量變換
function typeToCapacity(selectname) { 
    const capacity = modal.filter(item => item.name === selectname && item.capacity); 
    capacityselect.innerHTML = "";
    capacity.forEach(item => {
        capacityselect.innerHTML += ` <div class="col">
                    <div class="border rounded-3 p-4 d-flex justify-content-between mt-2" role="button" data-capacity="${item.capacity}">
                        <div class="fs-5">${item.capacity}</div>
                        <div class="fs-6">NT$${item.price} 起</div>
                    </div>
                </div>`;
    })
}
capacityselect.addEventListener("click", (e) => {    
    if(!e.target.closest(".col"))return;//避免點選到邊邊空白
    const targetcol = e.target.closest(".col").children[0];    
    CapacityselectChange(targetcol);
    selectcapacityItem = e.target.dataset.capacity;
    detailchange();//清單變化
})
function CapacityselectChange(targetcol) {
    Array.from(capacityselect.children).forEach(item => Array.from(item.children).forEach(item => item.classList.remove("border-primary")));
    targetcol.classList.add("border-primary");
}
//顏色選擇
function colorselectchange(targetcol) {
    Array.from(colorselect.children).forEach(item => Array.from(item.children).forEach(item => item.classList.remove("border-primary")));
    targetcol.classList.add("border-primary");
}
//顏色選擇 輪播牆 圖片變換
function imgchang(targetcolor) { 
    const carouse = modal.filter(item => item.type === "image" && item.name === selecttypeItem);
    const carousecolor = carouse.filter(item => item.color === targetcolor);      
    carouselimg.innerHTML = `<div class="carousel-item active">
                    <img src="${carousecolor[0].img}" class="d-block w-100" alt="...">
                </div>
                <div class="carousel-item">
                    <img src="${carousecolor[1].img}" class="d-block w-100" alt="...">
                </div>
                <div class="carousel-item">
                    <img src="${carousecolor[2].img}" class="d-block w-100" alt="...">
                </div>`;
    selectimageItem = carousecolor[2].img
}
const detailtitle = document.querySelector("#detail_title");
const detailtype = document.querySelector("#detail_type");

function detailchange() {  
    if (!selecttypeItem) return;
    if (!selectcapacityItem) return;
    detailtitle.innerHTML = `<h2 class="fs-1 fw-bold">你的全新 <br>${selecttypeItem}。</h2>
            <div class="fs-1 fw-bold">依你的需求量身打造。</div>
            <div><img class="w-100" src="${selectimageItem}" alt=""></div>`;

    const detailformat = modal.find(item => item.name === selecttypeItem && item.capacity === selectcapacityItem);
    console.log(detailformat);
    detailtype.innerHTML = `<div>${detailformat.name} ${detailformat.capacity} ${selectcolorItem}色鈦金屬</div>
                <div>NT$${detailformat.price}</div>`;

    //判斷最後清單顯示隱藏
    if (typebtnOne.classList.contains("border-primary") || typebtntwo.classList.contains("border-primary")) {
        Array.from(colorselect.children).forEach(col => {
            const innerDiv = Array.from(col.children).find(div => div.classList.contains("border-primary"));
            if (innerDiv) {
                Array.from(capacityselect.children).forEach(col => {
                    const innerDiv = Array.from(col.children).find(div => div.classList.contains("border-primary"));
                    if (innerDiv) {
                        detaildiv.classList.remove("d-none");
                    }
                });
            }
        });
    }
}

window.onload = function () {
    //初始頁面 頁面預設第一頁 iphone 15 pro
    const init = "iPhone_15_pro";
    pageTo15pro(init);
    const initCapacity = "iPhone 15 pro"
    typeToCapacity(initCapacity);
    detaildiv.classList.add("d-none");
    selecttypeItem = "iPhone 15 pro";
}
function init() {
    detaildiv.classList.add("d-none");
}
